<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç¾è‚¡è²¡å‹™æŒ‡æ¨™æŸ¥è©¢</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; padding: 20px; }
        .container { max-width: 600px; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .loading { display: none; }
        .data-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; }
        .data-label { font-weight: bold; color: #555; }
        .data-value { color: #007bff; font-family: monospace; font-size: 1.1em; }
    </style>
</head>
<body>

<div class="container mt-5">
    <h3 class="text-center mb-4">ğŸ“ˆ å°ç¾è‚¡æŒ‡æ¨™ (GitHub ç‰ˆ)</h3>
    
    <div class="input-group mb-3">
        <input type="text" id="symbolInput" class="form-control" placeholder="ä¾‹: AAPL æˆ– 2330.TW">
        <button class="btn btn-primary" onclick="fetchData()">æŸ¥è©¢</button>
    </div>
    <p class="text-muted small text-center">å°è‚¡è«‹å‹™å¿…åŠ  .TW (ä¸Šå¸‚) æˆ– .TWO (ä¸Šæ«ƒ)</p>

    <div id="loading" class="text-center my-3">
        <div class="spinner-border text-primary" role="status"></div>
        <div class="mt-2">æ­£åœ¨é€éä»£ç†ä¼ºæœå™¨è®€å–æ•¸æ“š...</div>
    </div>

    <div id="resultDisplay" style="display:none;">
        <div class="data-row"><span class="data-label">è‚¡ç¥¨ä»£ç¢¼</span><span id="resSymbol" class="data-value"></span></div>
        <div class="data-row"><span class="data-label">ç›®å‰è‚¡åƒ¹</span><span id="resPrice" class="data-value"></span></div>
        <div class="data-row"><span class="data-label">æœ¬ç›Šæ¯” (PE)</span><span id="resPE" class="data-value"></span></div>
        <div class="data-row"><span class="data-label">æ¯›åˆ©ç‡ (GM)</span><span id="resGM" class="data-value"></span></div>
    </div>
</div>

<script>
    async function fetchData() {
        let symbol = document.getElementById('symbolInput').value.trim().toUpperCase();
        if (!symbol) return alert("è«‹è¼¸å…¥ä»£ç¢¼");

        const loading = document.getElementById('loading');
        const resultDisplay = document.getElementById('resultDisplay');
        
        loading.style.display = 'block';
        resultDisplay.style.display = 'none';

        // æ ¸å¿ƒä¿®æ­£ï¼šä½¿ç”¨ cors-anywhere æˆ–é¡ä¼¼ä»£ç†
        // é€™è£¡ä½¿ç”¨ Yahoo Finance å…¬é–‹çš„ Summary API
        const baseUrl = `https://query1.finance.yahoo.com/v10/finance/quoteSummary/${symbol}?modules=summaryDetail,financialData`;
        const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(baseUrl)}`;

        try {
            const response = await fetch(proxyUrl);
            if (!response.ok) throw new Error("ä»£ç¢¼éŒ¯èª¤æˆ–ä»£ç†ä¼ºæœå™¨å¿™ç¢Œ");
            
            const json = await response.json();
            const data = json.quoteSummary.result[0];

            document.getElementById('resSymbol').innerText = symbol;
            document.getElementById('resPrice').innerText = data.financialData.currentPrice?.fmt || "N/A";
            document.getElementById('resPE').innerText = data.summaryDetail.trailingPE?.fmt || "N/A";
            document.getElementById('resGM').innerText = data.financialData.grossMargins?.fmt || "N/A";

            loading.style.display = 'none';
            resultDisplay.style.display = 'block';
        } catch (error) {
            loading.style.display = 'none';
            console.error(error);
            alert("æŸ¥è©¢å¤±æ•—ï¼š\n1. è«‹ç¢ºèªä»£ç¢¼æ­£ç¢º (ä¾‹: 2330.TW)\n2. ä»£ç†ä¼ºæœå™¨å¯èƒ½æš«æ™‚æ–·ç·šï¼Œè«‹ç¨å¾Œå†è©¦");
        }
    }
</script>

</body>
</html>
